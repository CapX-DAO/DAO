## ExecutorWithTimelock

- Time Locked Executor Contract, inherited by Aave Governance Executors.
- Contract that can queue, execute, cancel transactions voted by Governance.
- Queued transactions can be executed after a delay and until grace period is not over.

### Variables
- `uint8 public immutable override gracePeriod`:
      
   Time after delay in seconds when a proposal can be executed in      Proposal Queueing and Execution Period.

- `uint8 private _delay`:

   Minimum time between queueing and execution of proposal, in seconds.

- `uint8 public immutable override minimumDelay`:

   Lower threshold of `delay`, in seconds.

- `uint8 public immutable override maximumDelay`:

   Upper threshold of `delay`, in seconds.

- `address private _admin`:

   Address of current admin.

- `address private _pendingAdmin`:

   Address of pending admin that can later become admin.

- `mapping(bytes32 => bool) private _queuedTransactions`:
   
   Mapping of transactions to queued status(true or false).



### Modifiers

**onlyAdmin**

```solidity 
modifier onlyAdmin()
```

- Verifies msg.sender is admin or not.
- If msg.sender is admin then the next code flow of the function where modifier is called will be executed else returns message ONLY_BY_ADMIN.
 
**onlyTimelock**

```solidity 
modifier onlyTimelock()
```

- Verifies msg.sender is TimeLockExecutor or not.
- If msg.sender is TimeLockExecutor then the next code flow of the function where modifier is called will be executed else returns message ONLY_BY_THIS_TIMELOCK.
 
**onlyPendingAdmin**

```solidity 
modifier onlyPendingAdmin()
```

- Verifies msg.sender is pendingAdmin or not.
- If msg.sender is pendingAdmin then the next code flow of the function where modifier is called will be executed else returns message ONLY_BY_PENDING_ADMIN.
 
### Functions
**setDelay**

```solidity 
function setDelay(uint256 delay) public onlyTimeloc
```

Inputs required
 
- `delay`- delay between queue and execution of proposal

Functionality

- Method sets the delay in seconds.
- Method is defined with onlyTimeLock modifier. Hence,method should be executed by timelocked executor only.
 
**acceptAdmin**

```solidity 
function acceptAdmin() public onlyPendingAdmin
```
Functionality

- Method enables pending admin to become admin.
- Method is defined with onlyPendingAdmin modifier. Hence, the method should be executed by pendingAdmin only.
- Method sets pendingAdmin to the first address from the list of addresses(address[0]).
 
**setPendingAdmin**

```solidity 
function setPendingAdmin(address newPendingAdmin) public onlyTimelock
```

Inputs required

- `newPendingAdmin`- address of the new pendingAdmin

Functionality

- Method sets a new pending admin that can then become admin.
- Method is defined with onlyTimeLock modifier. Hence,method should be executed by timelocked executor only.
 
**queueTransaction**

```solidity 
function queueTransaction(address target,uint256 value,string memory signature,bytes memory data,uint256 executionTime, bool withDelegatecall) public override onlyAdmin returns (bytes32)
```

Inputs required:

- `target` -smart contract target

- `value`- wei value of the transaction

- `signature`- function signature of the transaction

- `data`-function arguments of the transaction or callData if signature empty

- `executionTime`- time at which to execute the transaction

- `withDelegatecall`- boolean, true = transaction delegatecalls the target, else calls the target

Returns

- action hash

Functionality

- Method is called by Governance that queues a transaction.
- Method is defined with onlyAdmin modifier. Hence,the method should be executed by admin only.
- Action hash is generated by using keccak256 algorithm.
 
 
**cancelTransaction**

```solidity 
function cancelTransaction(address target,uint256 value,string memory signature,bytes memory data,uint256 executionTime,bool withDelegatecall ) public override onlyAdmin returns (bytes32)
```

Inputs required

- `Target`- smart contract target
- `Value`- wei value of the transaction

- `Signature`- function signature of the transaction

- `data` -function arguments of the transaction or callData if signature empty

- `executionTime`- time at which to execute the transaction

- `withDelegatecall` -boolean, true = transaction delegatecalls the target, else calls the target

Returns

- action hash of the cancelled transaction

Functionality

- Method is defined with onlyAdmin modifier. Hence,the method should be executed by admin only.
- Action hash is generated by using keccak256 algorithm.
 
**executeTransaction**

```solidity 
function executeTransaction(address target,uint256 value,string memory signature,bytes memory data,uint256 executionTime,bool withDelegatecall) public payable override onlyAdmin returns (bytes memory)
```

Inputs required

- `target`- smart contract target
- `value`- wei value of the transaction
- `signature`- function signature of the transaction
- `data`- function arguments of the transaction or callData if signature empty
- `executionTime`- time at which to execute the transaction
- `withDelegatecall`- boolean, true = transaction delegatecalls the target, else calls the target

Returns

- callData executed as memory bytes

Functionality

- Method is called by Governance, that cancels a transaction..
- Method is defined with onlyAdmin modifier. Hence,the method should be executed by admin only.
- Method is defined with payable access modifier as some amount of ethers need to be sent while calling executeTransaction method.
 
**getAdmin()**
```solidity 
function getAdmin() external view override returns (address)
```
Returns

- address of the current admin

Functionality
- Method is a getter of the current admin address (should be governance).

 
**getPendingAdmin**
```solidity 
function getPendingAdmin() external view override returns (address)
```
Returns 

- address of the pending admin

Functionality
- Method is a getter of the current pending admin address.

 
**getDelay**
```solidity 
function getDelay() external view override returns (uint256)
```
Returns

- delay in seconds

Functionality
- Method is getter of the delay between queuing and execution.

 
**isActionQueued**
```solidity 
function isActionQueued(bytes32 actionHash) external view override returns (bool)
```
Inputs required

- `actionHash`-hash of the action to be checked

Returns

- true, if underlying action of actionHash is queued

Functionality
- Method checks whether an action (via actionHash) is queued.

 
**isProposalOverGracePeriod**
```solidity 
function isProposalOverGracePeriod(IAaveGovernanceV2 governance, uint256 proposalId) external view override returns (bool)
```
Inputs required
- `governance`- Governance contract
- `proposalId`- Id of the proposal against which to test

Returns

- returns true, if proposal is over grace period

Functionality
- Method checks whether a proposal is over its grace period.

 
**_validateDelay**
```solidity 
function _validateDelay(uint256 delay) external view override returns (bool)
```
Inputs required

- `delay`- delay between queue and execution of proposal

Returns

- true,if proposal is over grace period

Functionality
- Method compares delay with MINIMUM_DELAY and MAXIMUM_DELAY.


